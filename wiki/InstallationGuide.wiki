#labels installation
==Requirements==

  * JDK 1.6
  * Glassfish 2.2
  * Postgres 8.2+
  * Postgis 1.3+

I would recommend installing the JDK and Glassfish manually.
If you are running Ubuntu 8.04 then these versions of Postgres and Postgis are very easy to install. 
{{{
sudo apt-get install postgres postgis
}}}


==Installation==

*1. Make sure that the required software is installed properly*

*2. Create database and add spatial functionality*
  * In Postgres, create the database with the name "ergorr".
  * Change to the postgres user with the command: 
{{{
sudo su postgres
}}}
  * Enable plpqsql on the newly created database with the command:
{{{
createlang plpgsql ergorr
}}}
  * Run the postgis scripts on database "ergorr" to enable spatial functionality.
{{{
psql -d ergorr -f /usr/share/postgresql-8.3-postgis/lwpostgis.sql
psql -d ergorr -f /usr/share/postgresql-8.3-postgis/spatial_ref_sys.sql
}}}

*3. Checkout the source from google code and put it all under one directory.*

*4. Enable log4j for Glassfish *
  * When Glassfish is running open the web administration portal. (default port 4848).
  * Go to _Application Server_ from the left menu. Then _JVM Settings_ tab, followed by _Path Settings_ tab.
  * In the _System Classpath_ text field set the path of the log4j library and the directory of log4j.properties. These files can be found in the path <ergo_source_dir>/ErgoRR-shared/logging. An example input would be:
{{{
/home/me/proj/ErgoRR-shared/logging/log4j-1.2.15.jar
/home/me/proj/ErgoRR-shared/logging/
}}}

*5. Add Postgres connection datasource to Glassfish *
  * From the left menu click through _Resources_ > _JDBC_ > _Connection Pools_ and click _New_ to create a new pool with the following values.
    * Name: postgresPool
    * Resource Type: javax.sql.DataSource
    * Database Vendor: PostgreSQL
  * Click _Next_ to continue. In the following page scroll down and set your database properties (URL, user, password, ...). And click _Finish_.
  * Now that we have a connection pool, we need to create the data source.
  * From the left menu click through _Resources_ > _JDBC_ > _JDBC Resources_ and click _New_ to add a new resource with the following values:
    * JNDI Name: jdbc/ergorr
    * Pool Name: postgresPool (the one which you created)
  * And click _OK_ to finish.


*6. Open the 5 netbeans projects.*
  *ErgoRR-client < the client API

  *ErgoRR-commons < common classes

  *ErgoRR-enterprise < bundles the web application in an EAR

  *ErgoRR-jaxb < JAXB bindings

  *ErgoRR-persistence-ejb < persistence layer

  *ErgoRR-web-war < web application

  *There is another folder "ErgoRR-shared": these are just libraries.

*7. Add Glassfish to Netbeans* 
  * This can be done from the top menu _Tools_ > _Servers_.
  * Now you can set the project to run on your Glassfish installation.
    * Right click on the project _ErgoRR-enterprice_ to select _Properties_.
    * In the properties window select _Run_ from the left menu and select the server you have just configured in the _Server_ property field.

*8 You are done. Run the ErgoRR-enterprise project and hope for the best.


*Note: The installation process will be simplified in the future :) *
